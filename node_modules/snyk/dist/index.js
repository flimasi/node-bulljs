#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const process_1 = require("process");
const common = require("./common");
const fs = require("fs");
const errorContextMessage = 'Download Error (Runtime)';
function run(executable) {
    const cliArguments = common.getCliArguments(process_1.argv);
    const exitCode = common.runWrapper(executable, cliArguments);
    process.exit(exitCode);
}
try {
    const config = common.getCurrentConfiguration();
    const executable = config.getLocalLocation();
    if (!fs.existsSync(executable)) {
        console.warn("Executable doesn't exist, trying to download.");
        common
            .downloadExecutable(config.getDownloadLocation(), executable, config.getShasumFile())
            .then((error) => {
            if (error !== undefined) {
                common
                    .logError(errorContextMessage, error)
                    .then(() => process.exit(2));
            }
            else {
                run(executable);
            }
        })
            .catch((error) => {
            common.logError(errorContextMessage, error).then(() => process.exit(2));
        });
    }
    else {
        run(executable);
    }
}
catch (error) {
    common.logError(errorContextMessage, error).then(() => process.exit(2));
}
//# sourceMappingURL=index.js.map